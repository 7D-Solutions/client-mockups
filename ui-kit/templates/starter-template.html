<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Application - 7D Solutions</title>

    <!-- FireProof UI Kit -->
    <link rel="stylesheet" href="../ui-kit/css/tokens.css">
    <link rel="stylesheet" href="../ui-kit/css/reset.css">
    <link rel="stylesheet" href="../ui-kit/css/components.css">
    <script src="../ui-kit/js/mockup-core.js"></script>

    <style>
        /* Custom styles for your application */
        body {
            background: var(--color-bg-light);
        }

        .page-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-4);
        }

        /* Your custom CSS here */
    </style>
</head>
<body>
    <!-- Page Header -->
    <div class="page-header">
        <div class="container">
            <div class="page-title-row">
                <h1 class="page-title">ðŸ“Š My Application</h1>
                <div class="page-actions">
                    <button class="btn btn-primary" onclick="showModal('add-modal')">âž• Add New Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="page-container">
        <!-- Filters -->
        <div class="filter-bar">
            <div class="filter-group">
                <label>Search</label>
                <input type="text" class="form-control" placeholder="Search..." onkeyup="applyFilters()">
            </div>
            <div class="filter-group">
                <label>Status</label>
                <select class="form-control" onchange="applyFilters()">
                    <option value="">All</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                </select>
            </div>
            <button class="btn btn-secondary" onclick="clearFilters()">ðŸ”„ Clear Filters</button>
        </div>

        <!-- Data Table -->
        <div class="datatable-container">
            <!-- Toolbar -->
            <div class="datatable-toolbar">
                <div class="toolbar-left">
                    <span class="record-count">Showing <strong id="item-count">0</strong> items</span>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-secondary" onclick="exportData()">ðŸ“¥ Export</button>
                </div>
            </div>

            <!-- Table -->
            <div class="table-wrapper">
                <table class="datatable" id="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- Data will be rendered here -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <div class="pagination-info">
                    Showing <span id="pagination-info">0-0 of 0</span> items
                </div>
                <div class="pagination-controls">
                    <!-- Pagination controls rendered dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Backdrop -->
    <div id="modal-backdrop" class="modal-backdrop"></div>

    <!-- Add/Edit Modal -->
    <div id="add-modal" class="modal">
        <div class="modal-header">
            <h2 class="modal-title" id="modal-title">Add New Item</h2>
            <button class="modal-close" onclick="closeModal('add-modal')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="item-form" onsubmit="saveItem(event)">
                <div class="form-group">
                    <label class="form-label">Name *</label>
                    <input type="text" class="form-control" id="item-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select class="form-control" id="item-status">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-control" id="item-date">
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeModal('add-modal')">Cancel</button>
            <button class="btn btn-primary" onclick="saveItem(event)">Save Item</button>
        </div>
    </div>

    <script>
        // Initialize data store
        const dataStore = new MockupStore('my-app-data');

        // Pagination state
        let currentPage = 1;
        let itemsPerPage = 10;

        // Add sample data if empty
        if (dataStore.getAll().length === 0) {
            const sampleData = [
                { name: 'Sample Item 1', status: 'active', date: '2025-01-15' },
                { name: 'Sample Item 2', status: 'active', date: '2025-01-16' },
                { name: 'Sample Item 3', status: 'inactive', date: '2025-01-17' },
            ];
            sampleData.forEach(item => dataStore.add(item));
        }

        // Render table
        function renderTable() {
            let items = dataStore.getAll();

            // Calculate pagination
            const totalItems = items.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            // Ensure current page is valid
            if (currentPage > totalPages && totalPages > 0) {
                currentPage = totalPages;
            }
            if (currentPage < 1) {
                currentPage = 1;
            }

            // Get paginated data
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, totalItems);
            const paginatedItems = items.slice(startIndex, endIndex);

            const tbody = document.getElementById('table-body');
            document.getElementById('item-count').textContent = totalItems;

            // Update pagination info
            const startItem = totalItems > 0 ? startIndex + 1 : 0;
            document.getElementById('pagination-info').textContent = `${startItem}-${endIndex} of ${totalItems}`;

            // Render pagination controls
            renderPaginationControls(totalPages);

            if (paginatedItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="empty-state">No items found</td></tr>';
                return;
            }

            let html = '';
            paginatedItems.forEach(item => {
                html += `
                    <tr>
                        <td>${item.id}</td>
                        <td>${item.name}</td>
                        <td><span class="badge badge-${item.status === 'active' ? 'success' : 'secondary'}">${item.status}</span></td>
                        <td>${item.date}</td>
                        <td>
                            <button class="btn btn-sm btn-secondary" onclick="editItem('${item.id}')">Edit</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteItem('${item.id}')">Delete</button>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // Render pagination controls
        function renderPaginationControls(totalPages) {
            const paginationControls = document.querySelector('.pagination-controls');

            if (totalPages <= 1) {
                paginationControls.style.display = 'none';
                return;
            }

            paginationControls.style.display = 'flex';

            const getPageNumbers = () => {
                const pages = [];
                const maxVisible = 7;

                if (totalPages <= maxVisible) {
                    for (let i = 1; i <= totalPages; i++) {
                        pages.push(i);
                    }
                } else {
                    pages.push(1);
                    let start = Math.max(2, currentPage - 2);
                    let end = Math.min(totalPages - 1, currentPage + 2);

                    if (start > 2) pages.push('...');

                    for (let i = start; i <= end; i++) {
                        pages.push(i);
                    }

                    if (end < totalPages - 1) pages.push('...');
                    if (totalPages > 1) pages.push(totalPages);
                }

                return pages;
            };

            const pageNumbers = getPageNumbers();
            let html = '';

            html += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Â«</button>`;

            pageNumbers.forEach(page => {
                if (page === '...') {
                    html += `<span style="padding: 0 12px; display: flex; align-items: center; color: var(--color-text-light);">...</span>`;
                } else {
                    html += `<button class="page-btn ${page === currentPage ? 'active' : ''}" onclick="goToPage(${page})" ${page === currentPage ? 'disabled' : ''}>${page}</button>`;
                }
            });

            html += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Â»</button>`;

            paginationControls.innerHTML = html;
        }

        // Navigate to page
        function goToPage(page) {
            currentPage = page;
            renderTable();
        }

        // Save item
        function saveItem(e) {
            e.preventDefault();

            const data = {
                name: document.getElementById('item-name').value,
                status: document.getElementById('item-status').value,
                date: document.getElementById('item-date').value
            };

            dataStore.add(data);
            closeModal('add-modal');
            renderTable();
            Toast.success('Item saved successfully!');
        }

        // Edit item
        function editItem(id) {
            const item = dataStore.getById(id);
            if (!item) return;

            document.getElementById('item-name').value = item.name;
            document.getElementById('item-status').value = item.status;
            document.getElementById('item-date').value = item.date;

            showModal('add-modal');
        }

        // Delete item
        function deleteItem(id) {
            if (confirm('Are you sure you want to delete this item?')) {
                dataStore.delete(id);
                renderTable();
                Toast.success('Item deleted successfully!');
            }
        }

        // Apply filters
        function applyFilters() {
            renderTable();
        }

        // Clear filters
        function clearFilters() {
            renderTable();
        }

        // Export data
        function exportData() {
            Toast.info('Export functionality coming soon!');
        }

        // Modal functions
        function showModal(modalId) {
            ModalManager.show(modalId);
        }

        function closeModal(modalId) {
            ModalManager.hide(modalId);
        }

        // Initialize
        renderTable();
    </script>
</body>
</html>
